# 版本更新记录

```
0.1.1
2020-08-24
~~~~~~~~~~~~~~~~~~
1.增加回测功能，一键切换回测与实盘模式。
```

```
0.1.2
2020-08-25
~~~~~~~~~~~~~~~~~~
1.修复trade模块中订单状态为部分成交然后进行重发时委托数量为原下单数量减去已成交数量。
2.修正了storage模块中一个拼写错误。
```

```
0.1.5
2020-08-27
~~~~~~~~~~~~~~~~~~
1.修正示例策略。
2.修正trade模块中sell和sellshort函数的时间撤单以及撤单后超价下单的设置。
```

```
0.1.8
2020-08-29
~~~~~~~~~~~~~~~~~~
1.优化了storage模块中的kline_save()函数，调整了参数位置，以与其他函数的使用方式统一。
2.增加了一个手动记录持仓信息从而加快回测速度的双均线示例策略。
```

```
0.1.9
2020-08-31
~~~~~~~~~~~~~~~~~~
1.增加币安交易所的现货、交割、永续合约rest api。
2.修复并优化trade模块的下单函数的撤单重发功能。
3.双均线示例策略增加了初始化方法中读取数据库中的总利润的功能。
4.market模块的获取开、高、低、收价格函数，增加了回测时可以传入参数以获取历史k线上的开高低收价格的功能。
5.增加了一个回测兼实盘的布林强盗突破策略。
6.exceptions模块新增下单失败的异常抛出派生类。
```

```
0.1.10
2020-09-03
~~~~~~~~~~~~~~~~~~
1.trade模块中下单结果优化，现在返回的是一个字典，可以从中取出例如"成交均价"：
	info = exchange.buy(price, amount)
	avg_price = info["【交易提醒】下单结果"]["成交均价"]
	
	info = exchange.BUY(平空价格，平空数量，开多价格，开多数量)
	avg_price = info["平仓结果"]["【交易提醒】下单结果"]["成交均价"]
来计算实际的交易利润。
2.增加okex现货的双均线示例策略以及币本位交割合约双均线示例策略。
3.优化trade模块中的火币现货下单和查询订单失败时的异常抛出。
```

```
0.1.11
2020-09-04
~~~~~~~~~~~~~~~~~~
1.修复exchange下的binance sdk
2.优化trade模块中的各个交易所合约ID传入方式，现在完全统一。例如：
交割合约："BTC-USD-201225", "BTC-USDT-201225"
永续合约："BTC-USD-SWAP", "BTC-USDT-SWAP"
```

```
0.1.12
2020-09-04
~~~~~~~~~~~~~~~~~~
1.修复trade模块中合约面值为小数时数据类型转换失败的问题。
```

```
0.1.13
2020-09-05
~~~~~~~~~~~~~~~~~~
1.storage模块中增加存储币安k线的函数。
2.新增一个多参数回测的双均线示例策略。
```

```
0.1.15
2020-09-06
~~~~~~~~~~~~~~~~~~
1.优化logger模块，避免多进程访问同一个日志文件时报错；并且增加了控制台输出日志时不同级别的日志具有不同的颜色；当前路径下没有logs文件夹时会自动创建；logger模块的 使用方式简化，不用再进行初始化操作：
from purequant.logger import logger
logger.debug("我是一条日志")
```

```
0.1.16
2020-09-07
~~~~~~~~~~~~~~~~~~
1.优化logger模块，在使用logger记录异常信息时，直接使用logger.error()，可以是任何级别，不必传入任何参数，记录的日志包含了异常发生的准确地点，方便定位程序运行过程中产生的问题。
```

```
0.1.17
2020-09-07
~~~~~~~~~~~~~~~~~~
1.优化logger模块，减少冗余。
2.优化保存和读取txt文件的函数。
```

```
0.1.18
2020-09-10
~~~~~~~~~~~~~~~~~~
1.删除了原先的signalize模块，plot_signal文件夹中添加三个示例，通过rest api从交易所实时获取k线数据，
  绘制实时自动更新的k线和交易指标，实现本地电脑上的策略信号可视化。
2.time模块新增了一个sleep函数，其功能等同于time.sleep()。相应地也更新了一下示例策略。
```

```
0.1.19
2020-09-12
~~~~~~~~~~~~~~~~~~
1.增加bitmex交易所
3.四个交易所都增加了设置开仓杠杆倍数的功能，在初始化交易所时可以传入参数，如不传则默认设置为20倍杠杆。
2.修正布林强盗突破策略中出场均线参数的小问题。
```

```
0.1.21
2020-09-12
~~~~~~~~~~~~~~~~~~
1.修正okex合约的杠杆倍数设置
2.修正币安合约下单张数中的position side
3.优化trade模块的一些细节
4.market模块增加获取asks和bids的函数
```

```
0.1.22
2020-09-13
~~~~~~~~~~~~~~~~~~
1.修正布林强盗突破示例策略中的出场均线长度初始值为0导致计算均价指标时错误的问题。
2.okex和币安合约增加了在初始化时自动设置账户模式为全仓模式的功能，币安合约还会自动设置成单向持仓模式。
```

```
0.1.24
2020-09-17
~~~~~~~~~~~~~~~~~~
1.修正okex交割合约在初始化时设置杠杆倍数与设置全仓模式的顺序问题。
2.okex交割与永续合约如设置持仓模式或杠杆倍数失败，直接打印出错误，而不是抛出异常影响后面的代码运行。
```

```
0.1.25
2020-09-18
~~~~~~~~~~~~~~~~~~
1.okex合约获取订单信息时计算成交金额根据usdt本位及币本位进行区别计算。
2.增加一个实盘兼回测的海龟交易示例策略。
3.增加一个自定义csv数据源的实盘兼回测海龟交易策略。csv数据与回测结果可在论坛上下载：
http://purequant.club/forum.php?mod=viewthread&tid=32&fromuid=1
```

```
0.1.26
2020-09-20
~~~~~~~~~~~~~~~~~~
1.支持双向持仓信息查询。如果是单向持仓，使用原来的position.amount()、position.price()、position.direction()查询持仓信息。如果是双向持仓，获取多头持仓数量与均价：position.amount(mode="both", side="long"), position.price(mode="both", side="long")  获取空头持仓数量与均价：position.amount(mode="both", side="short"), position.price(mode="both", side="short")
2.币安合约支持双向持仓模式，在初始化交易所时传入参数即可：
exchange = BINANCEFUTURES(api_key, secret_key, instrument_id, leverage=10, position_side="both")
```

```
0.1.27
2020-09-29
~~~~~~~~~~~~~~~~~~
1.删除了几个模块
2.logger模块还原到之前的版本，可以分片保存日志。
3.trade模块增加了获取账户权益的函数，用以获取账户余额来绘制动态资金曲线。绘制动态资金曲线的示例代码在论坛的策略广场版块。
```

```
0.1.28
2020-10-04
~~~~~~~~~~~~~~~~~~
1.修正storage模块中存储k线的函数。
```

```
1.1.0
2020-10-08
~~~~~~~~~~~~~~~~~~
1.修复logger模块重复输出日志的问题
2.增加了一个bitmexws模块，用于在bitmex交易所进行交易，通过websocket接口获取数据，bitmex只能使用rest api来下单撤单。
3.增加一个bitmex交易所XBTUSD交易对的简单买单maker示例策略。
```

```
1.1.1
2020-10-11
~~~~~~~~~~~~~~~~~~
1.新增一个ccxt_exchanges模块，可以使用这个模块对ccxt框架支持的交易所进行交易。指标模块完全兼容这些交易所。
```

```
1.1.2
2020-10-13
~~~~~~~~~~~~~~~~~~
1.indicators模块中BarUpdate函数增加对浮点数类型的时间戳的兼容。
2.修正配置模块和配置文件。
```

```
1.1.7
2020-10-23
~~~~~~~~~~~~~~~~~~
1.storage模块新增一个combine_kline函数，用以将1自定义csv数据源的1分钟k线是数据合成为任意周期的k线数据。
```

```
1.2.0
2020-10-24
~~~~~~~~~~~~~~~~~~
1.修正storage模块中的combine_kline函数，经与交易所k线图上数据比较，合成的k线数据开高低收价格一致，成交量略微不同，相差极小。
```

```
1.3.0
2020-10-27
~~~~~~~~~~~~~~~~~~
1.增加bitcoke交易所：
from purequant.trade import BITCOKE
exchange = BITCOKE(
                   "api_key",
				  "secret_key",
                    currency="EOS",
                    instrument_id="XEOSUSD",
                    leverage=20,
                    position_side="both"
                    )
2.将原先的BITMEXWS模块与ccxt_exchanges模块移动到了trade模块中：
from purequant.trade import BITMEXWS
from purequant.trade import CCXTEXCHANGE
```

```
1.3.2
2020-10-28
~~~~~~~~~~~~~~~~~~
1.修复BITCOKE的k线时间戳格式以及单向持仓模式下的get_position函数的返回值。
2.增加MXC交易所
```

```
1.4.0
2020-10-30
~~~~~~~~~~~~~~~~~~
1.OKEX交割合约与永续合约、币安交割合约与永续合约、Bitcoke,在初始化时可以指定margin_mode="fixed"，设置成逐仓模式，否则自动设置为全仓模式。火币与Bitmex没有切换全仓与逐仓模式的接口，可以在交易所上手动设置。
```

```
1.4.1
2020-11-02
~~~~~~~~~~~~~~~~~~
1.增加bybit交易所的正向和反向合约
```

```
1.4.2
2020-11-05
~~~~~~~~~~~~~~~~~~
1.考虑到大家排查问题和解决问题的能力，将示例策略中的初始化方法去除了容错处理，这样在初始化时如果出错就会直接抛出异常停止程序。
2.OKEX合约初始化时，如果因为当前有持仓 或挂单导致账户模式设置失败，会输出日志，日志是输出到文件还是控制台，取决于配置文件中的设置。
3.日志模块由原先的保留最近10个文件改为保留最近1000个文件。
```

```
1.4.3
2020-11-11
~~~~~~~~~~~~~~~~~~
1.指标模块优化，回测时不需要再对时间戳的格式进行处理。
2.币安的sdk将请求时间戳修改为币安服务器的时间戳。
3.日志模块保存的日志名称自动创建为error.log，保存至文件时恢复默认保存10个日志文件。
```























